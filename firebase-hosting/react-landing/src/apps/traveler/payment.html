<!DOCTYPE html>
<html>
<head>
  <title>LambdaTrip - Upgrade to Premium</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Tailwind + site CSS (same as index.html) -->
  <link rel="stylesheet" href="./css/tailwind-build.css" />
  <link rel="stylesheet" href="./css/index.css" />
  <!-- Bootstrap Icons (same as index.html) -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.3/font/bootstrap-icons.min.css"
    integrity="sha512-dPXYcDub/aeb08c63jRq/k6GaKccl256JQy/AnOq7CAnEZ9FzSL9wSbcZkMp4R26vBsMLFYH4kQ67/bbV8XaCQ=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />

  <style>
    /* Selection highlight to mirror the "selected" state */
    .plan.selected {
      border-color: #a78bfa !important; /* tw-purple-300 */
      background: #faf5ff; /* subtle highlight */
      transform: scale(1.03);
      transition: all 0.2s ease;
      box-shadow: 0 10px 25px rgba(168, 85, 247, 0.12);
    }
  </style>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <!-- Firestore Stripe Payments SDK -->
  <script src="https://unpkg.com/@invertase/firestore-stripe-payments@latest/dist/index.umd.js"></script>
</head>
<body class="tw-bg-white tw-text-black">
  <header class="tw-absolute tw-top-0 tw-left-0 tw-right-0 tw-z-30 tw-flex tw-h-[60px] tw-w-full tw-px-[5%]">
    <!-- Left: Logo -->
    <a class="tw-h-[50px] tw-w-[50px] tw-p-[4px]" href="/">
      <img
        src="./assets/logo/logo.png"
        alt="LambdaTrip Logo"
        class="tw-object tw-h-full tw-w-full tw-shadow-lg"
      />
    </a>

    <!-- Right: Actions (pushed right with ml-auto) -->
    <div class="tw-ml-auto tw-flex tw-items-center tw-gap-[20px]">
      <button id="google-signin"
        class="btn tw-bg-[#ea4335] tw-text-white tw-rounded-md tw-px-4 tw-py-2 tw-shadow-lg"
        style="display:none;">
        <i class="bi bi-google"></i>
        <span class="tw-ml-2">Sign in with Google</span>
      </button>
    </div>
  </header>

  <div class="tw-min-h-[100vh] tw-w-full tw-flex tw-items-center tw-justify-center tw-p-6 tw-pt-[70px]">
    <div class="tw-w-full tw-max-w-3xl tw-mx-auto">
      <div class="tw-text-center tw-mb-8">
        <h1 class="tw-text-4xl tw-font-bold tw-mb-2">Upgrade to LambdaTrip Premium</h1>
        <p class="tw-text-gray-700">Get unlimited landmark analysis and premium features</p>
      </div>

      <!-- Plans -->
      <div class="reveal-up tw-mt-10 tw-flex tw-flex-wrap tw-place-content-center tw-gap-10 max-lg:tw-flex-col">
        <!-- Monthly Plan -->
        <div class="plan tw-bg-white tw-border-10 tw-border-gray-100 tw-rounded-2xl tw-p-8 tw-relative tw-transition-all tw-duration-300 hover:tw-shadow-xl hover:tw-border-purple-300 hover:tw-scale-105 tw-shadow-lg selected"
             onclick="selectPlan('monthly', event)">
          <div class="tw-text-center tw-mb-6">
            <div class="tw-w-16 tw-h-16 tw-bg-purple-100 tw-rounded-full tw-flex tw-items-center tw-justify-center tw-mx-auto tw-mb-4">
              <i class="bi bi-lightning-charge tw-text-3xl tw-text-purple-600"></i>
            </div>
            <h3 class="tw-text-2xl tw-font-bold tw-mb-2">Monthly Pro</h3>
            <div class="tw-text-4xl tw-font-bold tw-mb-2">
              <span class="tw-text-2xl">$</span>9.99
              <span class="tw-text-base tw-text-gray-500 tw-font-normal">/ month</span>
            </div>
            <div class="tw-text-green-600 tw-font-semibold">&nbsp;</div>
          </div>
          <ul class="tw-space-y-3">
            <li class="tw-flex tw-items-center tw-gap-3">
              <i class="bi bi-check-circle-fill tw-text-green-500 tw-text-xl"></i>
              <span>Unlimited landmark analyses</span>
            </li>
            <li class="tw-flex tw-items-center tw-gap-3">
              <i class="bi bi-check-circle-fill tw-text-green-500 tw-text-xl"></i>
              <span>Weather & Safety alerts</span>
            </li>
            <li class="tw-flex tw-items-center tw-gap-3">
              <i class="bi bi-check-circle-fill tw-text-green-500 tw-text-xl"></i>
              <span>Premium AI insights</span>
            </li>
            <li class="tw-flex tw-items-center tw-gap-3">
              <i class="bi bi-check-circle-fill tw-text-green-500 tw-text-xl"></i>
              <span>Advanced travel recommendations</span>
            </li>
            <li class="tw-flex tw-items-center tw-gap-3">
              <i class="bi bi-check-circle-fill tw-text-green-500 tw-text-xl"></i>
              <span>Priority support</span>
            </li>
          </ul>
        </div>

        <!-- Yearly Plan -->
        <div class="plan tw-bg-white tw-border-10 tw-border-gray-100 tw-rounded-2xl tw-p-8 tw-relative tw-transition-all tw-duration-300 hover:tw-shadow-xl hover:tw-border-purple-300 hover:tw-scale-105 tw-shadow-lg"
             onclick="selectPlan('yearly', event)">
          <div class="tw-text-center tw-mb-6">
            <div class="tw-w-16 tw-h-16 tw-bg-green-100 tw-rounded-full tw-flex tw-items-center tw-justify-center tw-mx-auto tw-mb-4">
              <i class="bi bi-star tw-text-3xl tw-text-green-600"></i>
            </div>
            <h3 class="tw-text-2xl tw-font-bold tw-mb-2">Yearly Pro</h3>
            <div class="tw-text-4xl tw-font-bold tw-mb-2">
              <span class="tw-text-2xl">$</span>99.99
              <span class="tw-text-base tw-text-gray-500 tw-font-normal">/ year</span>
            </div>
            <div class="tw-text-green-600 tw-font-semibold">Save 17%</div>
          </div>
          <ul class="tw-space-y-3">
            <li class="tw-flex tw-items-center tw-gap-3">
              <i class="bi bi-check-circle-fill tw-text-green-500 tw-text-xl"></i>
              <span>Unlimited landmark analyses</span>
            </li>
            <li class="tw-flex tw-items-center tw-gap-3">
              <i class="bi bi-check-circle-fill tw-text-green-500 tw-text-xl"></i>
              <span>Weather & Safety alerts</span>
            </li>
            <li class="tw-flex tw-items-center tw-gap-3">
              <i class="bi bi-check-circle-fill tw-text-green-500 tw-text-xl"></i>
              <span>Premium AI insights</span>
            </li>
            <li class="tw-flex tw-items-center tw-gap-3">
              <i class="bi bi-check-circle-fill tw-text-green-500 tw-text-xl"></i>
              <span>Advanced travel recommendations</span>
            </li>
            <li class="tw-flex tw-items-center tw-gap-3">
              <i class="bi bi-check-circle-fill tw-text-green-500 tw-text-xl"></i>
              <span>Priority support</span>
            </li>
            <li class="tw-flex tw-items-center tw-gap-3">
              <i class="bi bi-check-circle-fill tw-text-green-500 tw-text-xl"></i>
              <span>Early access to new features</span>
            </li>
          </ul>
        </div>
        
      </div>

      <!-- Actions -->
      <!-- <div class="tw-flex tw-justify-center tw-text-center tw-gap-4"> -->
      <div class="tw-mt-6 tw-flex tw-flex-wrap tw-place-content-center tw-gap-5 max-lg:tw-flex-col">
        <button id="google-signin"
          class="btn tw-bg-[#ea4335] tw-text-white tw-rounded-md tw-px-4 tw-py-2"
          style="display:none;">
          <i class="bi bi-google"></i>
          <span class="tw-ml-2">Sign in with Google</span>
        </button>
        <button class="btn tw-bg-black tw-text-white tw-rounded-md tw-px-6 tw-py-3"
                id="upgrade-btn" onclick="processPayment()">
          <i class="bi bi-send-fill"></i>
          <span class="tw-ml-2">Upgrade Now</span>
        </button>
        <button class="btn tw-bg-gray-600 tw-text-white tw-rounded-md tw-px-6 tw-py-3"
        onclick="window.location.assign('https://lambdatrip.web.app/')">
          Cancel
        </button>
      </div>
    </div>
  </div>

  <script>
    // Firebase config from your project
    const firebaseConfig = {
      apiKey: "AIzaSyDB2SxvMTUYNY53hhYOFqHLCD7zpoztt-Y",
      authDomain: "lambdatrip.firebaseapp.com",
      projectId: "lambdatrip",
      storageBucket: "lambdatrip.appspot.com",
      messagingSenderId: "105431370700",
      appId: "1:105431370700:web:5c0d29fc9a6686c207ab69",
      measurementId: "G-TB7ZWRP97W"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Stripe Price IDs
    const PRICE_ID_MONTHLY = "price_1RrOvnA19cxqArZjFCHSTMTR";
    const PRICE_ID_YEARLY = "price_1RrOvnA19cxqArZjjtgMZjP9";

    let selectedPlan = 'monthly';

    function selectPlan(plan, event) {
      selectedPlan = plan;
      document.querySelectorAll('.plan').forEach(p => p.classList.remove('selected'));
      event.currentTarget.classList.add('selected');
    }

    // Show/hide sign-in button based on auth state
    auth.onAuthStateChanged((user) => {
      const signInBtn = document.getElementById('google-signin');
      const upgradeBtn = document.getElementById('upgrade-btn');
      if (!user) {
        signInBtn.style.display = 'block';
        upgradeBtn.disabled = true;
        upgradeBtn.classList.add('tw-opacity-50', 'tw-cursor-not-allowed');
      } else {
        signInBtn.style.display = 'none';
        upgradeBtn.disabled = false;
        upgradeBtn.classList.remove('tw-opacity-50', 'tw-cursor-not-allowed');
      }
    });

    document.getElementById('google-signin').onclick = function() {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider);
    };

    async function processPayment() {
      const user = auth.currentUser;
      if (!user) {
        alert("Please sign in first!");
        return;
      }
      const priceId = selectedPlan === 'monthly' ? PRICE_ID_MONTHLY : PRICE_ID_YEARLY;
      // Create a new checkout session in Firestore
      const docRef = await db.collection("customers")
        .doc(user.uid)
        .collection("checkout_sessions")
        .add({
          price: priceId,
          success_url: window.location.origin,
          cancel_url: window.location.origin,
        });
      // Listen for the session URL
      docRef.onSnapshot((snap) => {
        const data = snap.data();
        if (!data) return;
        const { error, url } = data;
        if (error) {
          alert(`An error occurred: ${error.message}`);
        }
        if (url) {
          window.location.assign(url);
        }
      });
    }
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.0/gsap.min.js" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.0/ScrollTrigger.min.js" crossorigin="anonymous"></script>
  <script>
    gsap.registerPlugin(ScrollTrigger);
    gsap.set(".reveal-up", { opacity: 0, y: 60 });

    gsap.utils.toArray(".reveal-up").forEach((el) => {
      gsap.to(el, {
        opacity: 1,
        y: 0,
        duration: 0.6,
        ease: "power2.out",
        scrollTrigger: {
          trigger: el,
          start: "top 85%",
        },
      });
    });
  </script>
</body>
</html> 